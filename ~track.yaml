output_format: markdown
# T7 - –ü–æ–∏—Å–∫ –∏ –∞–Ω–∞–ª–∏–∑ Telegram –∫–∞–Ω–∞–ª–æ–≤ –¥–ª—è —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏ | v1.0

variables:
  # –í–•–û–î–ù–ê–Ø –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è (–∑–∞–º–µ–Ω—è–µ—Ç—Å—è —Ç–µ–∫—Å—Ç–æ–º –∏–∑ –±–æ—Ç–∞)
  target_audience: ""

  # –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
  channels_urls: ""
  current_page_html: ""
  current_page_clean: ""
  raw_data_array: "[]"
  final_json: "{}"
  final_md: ""

nodes:
  # 1. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ URL –∫–∞–Ω–∞–ª–æ–≤
  - name: get_channels_list
    type: genText
    echo: "üîç –ü–æ–∏—Å–∫ Telegram –∫–∞–Ω–∞–ª–æ–≤ –¥–ª—è –∞—É–¥–∏—Ç–æ—Ä–∏–∏: {{target_audience}}"
    prompt: |
      –ù–∞–π–¥–∏ 10 –†–ï–ê–õ–¨–ù–´–• Telegram –∫–∞–Ω–∞–ª–æ–≤ –¥–ª—è —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏: {{target_audience}}

      –ò—Å–ø–æ–ª—å–∑—É–π –≤–µ–±-–ø–æ–∏—Å–∫ –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤.

      –í–ê–ñ–ù–û: –í—ã–≤–µ–¥–∏ –¢–û–õ–¨–ö–û —Å–ø–∏—Å–æ–∫ URL –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
      t.me/channelname1
      t.me/channelname2
      t.me/channelname3

      –ë–µ–∑ –Ω—É–º–µ—Ä–∞—Ü–∏–∏, –±–µ–∑ –æ–ø–∏—Å–∞–Ω–∏–π, —Ç–æ–ª—å–∫–æ —á–∏—Å—Ç—ã–µ URL –∫–∞–Ω–∞–ª–æ–≤ (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É).
    model: "gpt-4o-mini"
    web_search: true
    log: { md: true, stdout: 400 }
    save_to_variable: "channels_urls"

  # 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–∂–¥–æ–≥–æ –∫–∞–Ω–∞–ª–∞ —á–µ—Ä–µ–∑ iterate - –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ raw –¥–∞–Ω–Ω—ã—Ö
  - name: process_channels
    type: iterate
    echo: "üì± –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –ø–æ –∫–∞–Ω–∞–ª–∞–º..."
    iterate_lines: "{{channels_urls}}"
    nodes:
      # 2.1. –ó–∞–≥—Ä—É–∑–∫–∞ HTML —Å—Ç—Ä–∞–Ω–∏—Ü—ã
      - name: fetch_page
        type: langchainTool
        tool_name: "web_fetch"
        echo: "  ‚îî‚îÄ –ó–∞–≥—Ä—É–∑–∫–∞: {{iterate}}"
        arguments:
          url: "https://{{iterate}}"
        tool_config: {}
        save_to_variable: "current_page_html"

      # 2.2. –û—á–∏—Å—Ç–∫–∞ HTML —á–µ—Ä–µ–∑ lxml_cleaner
      - name: clean_html
        type: langchainTool
        tool_name: "lxml_cleaner"
        arguments:
          html_content: "{{current_page_html}}"
        tool_config: {}
        save_to_variable: "current_page_clean"

      # 2.3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ raw –¥–∞–Ω–Ω—ã—Ö –≤ JSON –º–∞—Å—Å–∏–≤
      - name: append_raw_data
        type: placeholder
        echo: "  ‚îî‚îÄ –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö: {{iterate}}"
        template_content: |
          {{raw_data_array}}{"url":"{{iterate}}","raw_data":"{{current_page_clean}}"}
        save_to_variable: "raw_data_array"

      # 2.4. –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
      - name: delay_between_requests
        type: delay
        seconds: 2
        echo: "  ‚îî‚îÄ –ü–∞—É–∑–∞ 2 —Å–µ–∫..."

  # 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º
  - name: process_all_data
    type: genText
    echo: "üîß –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö..."
    prompt: |
      –ü—Ä–µ–æ–±—Ä–∞–∑—É–π –º–∞—Å—Å–∏–≤ —Å raw –¥–∞–Ω–Ω—ã–º–∏ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON.

      –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ —Å url –∏ raw_data):
      {{raw_data_array}}

      –î–ª—è –ö–ê–ñ–î–û–ì–û —ç–ª–µ–º–µ–Ω—Ç–∞ –º–∞—Å—Å–∏–≤–∞ –∏–∑–≤–ª–µ–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ raw_data –∏ –≤–µ—Ä–Ω–∏ –≤–∞–ª–∏–¥–Ω—ã–π JSON:
      {
        "target_audience": "{{target_audience}}",
        "channels": [
          {
            "url": "t.me/channelname",
            "name": "–Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞",
            "description": "–æ–ø–∏—Å–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞",
            "subscribers": "–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤"
          }
        ],
        "total_count": N
      }

      –í–ê–ñ–ù–û:
      - –û–±—Ä–∞–±–æ—Ç–∞–π –í–°–ï —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ –≤—Ö–æ–¥–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞
      - –í–µ—Ä–Ω–∏ –¢–û–õ–¨–ö–û –≤–∞–ª–∏–¥–Ω—ã–π JSON
      - –ë–ï–ó markdown —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
      - –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–π "N/A"
    model: "gpt-4o-mini"
    log: { md: true, stdout: 400 }
    save_to_variable: "final_json"

  # 4. –°–æ–∑–¥–∞–Ω–∏–µ —á–∏—Ç–∞–µ–º–æ–π MD –≤–µ—Ä—Å–∏–∏ –¥–ª—è –æ—Ç—á–µ—Ç–∞
  - name: create_markdown_report
    type: genText
    echo: "üìÑ –°–æ–∑–¥–∞–Ω–∏–µ —á–∏—Ç–∞–µ–º–æ–≥–æ –æ—Ç—á–µ—Ç–∞..."
    prompt: |
      –ü—Ä–µ–æ–±—Ä–∞–∑—É–π JSON –¥–∞–Ω–Ω—ã–µ –≤ –∫—Ä–∞—Å–∏–≤—ã–π markdown –æ—Ç—á–µ—Ç:

      {{final_json}}

      –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç—á–µ—Ç–∞:
      # Telegram –∫–∞–Ω–∞–ª—ã –¥–ª—è: {{target_audience}}

      ## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
      - –ù–∞–π–¥–µ–Ω–æ –∫–∞–Ω–∞–ª–æ–≤: [—á–∏—Å–ª–æ]
      - –î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞: [—Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞]

      ## –¢–æ–ø –∫–∞–Ω–∞–ª—ã

      ### 1. [–ù–∞–∑–≤–∞–Ω–∏–µ]
      - **URL:** t.me/...
      - **–ü–æ–¥–ø–∏—Å—á–∏–∫–∏:** ...
      - **–û–ø–∏—Å–∞–Ω–∏–µ:** ...

      [–ø—Ä–æ–¥–æ–ª–∂–∏ –¥–ª—è –≤—Å–µ—Ö –∫–∞–Ω–∞–ª–æ–≤]

      ## –í—ã–≤–æ–¥—ã
      [–ö—Ä–∞—Ç–∫–∏–π –∞–Ω–∞–ª–∏–∑ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤]
    model: "gpt-4o-mini"
    log: { md: true, stdout: 400 }
    save_to_variable: "final_md"

  # 5. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
  - name: save_json
    type: placeholder
    echo: "üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ JSON..."
    template_content: "{{final_json}}"
    save_to_track: "result/t7_result.json"

  - name: save_markdown
    type: placeholder
    echo: "üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–∞..."
    template_content: "{{final_md}}"
    save_to_track: "result/t7_result.md"
